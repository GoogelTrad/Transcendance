{"ast":null,"code":"/*\n\nimport { socket }  from \"../socket\";\nimport { useEffect, useRef } from \"react\";\n\n\nexport default function Room() {\n\n\tconst socket = useRef(null);\n\n\tuseEffect(() => {\n\t\tsocket.current = new WebSocket('ws://localhost:8000/ws/chat/');\n\n\t\tsocket.current.onopen = () => {\n\t\tconsole.log('WebSocket connected');\n\t\t};\n\n\t\tsocket.current.onclose = () => {\n\t\tconsole.log('WebSocket disconnected');\n\t\t};\n\n\t\treturn () => {\n\t\tsocket.current.close();\n\t\t};\n\t}, []);\n\n\t//const roomName = JSON.parse(document.getElementById('room-name').textContent);\n\n\t// document.querySelector('#chat-message-input').focus();\n\t// document.querySelector('#chat-message-input').onkeyup = function(e) {\n\t// \tif (e.key === 'Enter') {  // enter, return\n\t// \t\tdocument.querySelector('#chat-message-submit').click();\n\t// \t}\n\t// };\n\n\t// document.querySelector('#chat-message-submit').onclick = function(e) {\n\t// \tconst messageInputDom = document.querySelector('#chat-message-input');\n\t// \tconst message = messageInputDom.value;\n\t// \tsocket.emit('message', JSON.stringify({\n\t// \t\t'message': message\n\t// \t}));\n\t// \tmessageInputDom.value = '';\n\t// };\n\n\treturn (\n\t\t<>\n    \t\t<textarea id=\"chat-log\" cols=\"100\" rows=\"20\"></textarea>\n    \t\t<input id=\"chat-message-input\" type=\"text\" size=\"100\"/>\n    \t\t<input id=\"chat-message-submit\" type=\"button\" value=\"Send\"/>\n\t\t</>)\n}\n\n*/\n\nconst roomName = JSON.parse(document.getElementById('room-name').textContent);\nconst chatSocket = new WebSocket(`ws://${window.location.host}/ws/chat/${roomName}/`);\nchatSocket.onmessage = function (e) {\n  const data = JSON.parse(e.data);\n  const messageElement = document.createElement('div');\n  messageElement.textContent = `${data.username}: ${data.message}`;\n  document.querySelector('#chat-log').appendChild(messageElement);\n};\nchatSocket.onclose = function (e) {\n  console.error('Chat socket closed unexpectedly');\n};\ndocument.querySelector('#chat-message-input').onkeyup = function (e) {\n  if (e.keyCode === 13) {\n    // Enter key\n    const messageInputDom = document.querySelector('#chat-message-input');\n    const message = messageInputDom.value;\n    chatSocket.send(JSON.stringify({\n      'message': message\n    }));\n    messageInputDom.value = '';\n  }\n};","map":{"version":3,"names":["roomName","JSON","parse","document","getElementById","textContent","chatSocket","WebSocket","window","location","host","onmessage","e","data","messageElement","createElement","username","message","querySelector","appendChild","onclose","console","error","onkeyup","keyCode","messageInputDom","value","send","stringify"],"sources":["/home/frontend/core/src/chat/index.js"],"sourcesContent":["/*\n\nimport { socket }  from \"../socket\";\nimport { useEffect, useRef } from \"react\";\n\n\nexport default function Room() {\n\n\tconst socket = useRef(null);\n\n\tuseEffect(() => {\n\t\tsocket.current = new WebSocket('ws://localhost:8000/ws/chat/');\n\n\t\tsocket.current.onopen = () => {\n\t\tconsole.log('WebSocket connected');\n\t\t};\n\n\t\tsocket.current.onclose = () => {\n\t\tconsole.log('WebSocket disconnected');\n\t\t};\n\n\t\treturn () => {\n\t\tsocket.current.close();\n\t\t};\n\t}, []);\n\n\t//const roomName = JSON.parse(document.getElementById('room-name').textContent);\n\n\t// document.querySelector('#chat-message-input').focus();\n\t// document.querySelector('#chat-message-input').onkeyup = function(e) {\n\t// \tif (e.key === 'Enter') {  // enter, return\n\t// \t\tdocument.querySelector('#chat-message-submit').click();\n\t// \t}\n\t// };\n\n\t// document.querySelector('#chat-message-submit').onclick = function(e) {\n\t// \tconst messageInputDom = document.querySelector('#chat-message-input');\n\t// \tconst message = messageInputDom.value;\n\t// \tsocket.emit('message', JSON.stringify({\n\t// \t\t'message': message\n\t// \t}));\n\t// \tmessageInputDom.value = '';\n\t// };\n\n\treturn (\n\t\t<>\n    \t\t<textarea id=\"chat-log\" cols=\"100\" rows=\"20\"></textarea>\n    \t\t<input id=\"chat-message-input\" type=\"text\" size=\"100\"/>\n    \t\t<input id=\"chat-message-submit\" type=\"button\" value=\"Send\"/>\n\t\t</>)\n}\n\n*/\n\nconst roomName = JSON.parse(document.getElementById('room-name').textContent);\nconst chatSocket = new WebSocket(\n    `ws://${window.location.host}/ws/chat/${roomName}/`\n);\n\nchatSocket.onmessage = function(e) {\n    const data = JSON.parse(e.data);\n    const messageElement = document.createElement('div');\n    messageElement.textContent = `${data.username}: ${data.message}`;\n    document.querySelector('#chat-log').appendChild(messageElement);\n};\n\nchatSocket.onclose = function(e) {\n    console.error('Chat socket closed unexpectedly');\n};\n\ndocument.querySelector('#chat-message-input').onkeyup = function(e) {\n    if (e.keyCode === 13) {  // Enter key\n        const messageInputDom = document.querySelector('#chat-message-input');\n        const message = messageInputDom.value;\n        chatSocket.send(JSON.stringify({\n            'message': message\n        }));\n        messageInputDom.value = '';\n    }\n};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMA,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACC,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAC,CAACC,WAAW,CAAC;AAC7E,MAAMC,UAAU,GAAG,IAAIC,SAAS,CAC5B,QAAQC,MAAM,CAACC,QAAQ,CAACC,IAAI,YAAYV,QAAQ,GACpD,CAAC;AAEDM,UAAU,CAACK,SAAS,GAAG,UAASC,CAAC,EAAE;EAC/B,MAAMC,IAAI,GAAGZ,IAAI,CAACC,KAAK,CAACU,CAAC,CAACC,IAAI,CAAC;EAC/B,MAAMC,cAAc,GAAGX,QAAQ,CAACY,aAAa,CAAC,KAAK,CAAC;EACpDD,cAAc,CAACT,WAAW,GAAG,GAAGQ,IAAI,CAACG,QAAQ,KAAKH,IAAI,CAACI,OAAO,EAAE;EAChEd,QAAQ,CAACe,aAAa,CAAC,WAAW,CAAC,CAACC,WAAW,CAACL,cAAc,CAAC;AACnE,CAAC;AAEDR,UAAU,CAACc,OAAO,GAAG,UAASR,CAAC,EAAE;EAC7BS,OAAO,CAACC,KAAK,CAAC,iCAAiC,CAAC;AACpD,CAAC;AAEDnB,QAAQ,CAACe,aAAa,CAAC,qBAAqB,CAAC,CAACK,OAAO,GAAG,UAASX,CAAC,EAAE;EAChE,IAAIA,CAAC,CAACY,OAAO,KAAK,EAAE,EAAE;IAAG;IACrB,MAAMC,eAAe,GAAGtB,QAAQ,CAACe,aAAa,CAAC,qBAAqB,CAAC;IACrE,MAAMD,OAAO,GAAGQ,eAAe,CAACC,KAAK;IACrCpB,UAAU,CAACqB,IAAI,CAAC1B,IAAI,CAAC2B,SAAS,CAAC;MAC3B,SAAS,EAAEX;IACf,CAAC,CAAC,CAAC;IACHQ,eAAe,CAACC,KAAK,GAAG,EAAE;EAC9B;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}